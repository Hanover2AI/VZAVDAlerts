[
    {
        "index": 1,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for the hostpool.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-50-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Capacity-50-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 50 and HostPoolPercentLoad < 85\r\n          | where HostPoolName =~ 'hp-uks-p-avd-001'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 3,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 2,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for the hostpool.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-50-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Cap-50-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 50 and HostPoolPercentLoad < 85\r\n          | where HostPoolName =~ 'hp-uks-p-avd-002'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 3,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 3,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for the hostpool.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-85-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Capacity-85-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 85 and HostPoolPercentLoad < 95\r\n          | where HostPoolName =~ 'hp-uks-p-avd-001'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 4,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for the hostpool.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-85-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Capacity-85-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 85 and HostPoolPercentLoad < 95\r\n          | where HostPoolName =~ 'hp-uks-p-avd-002'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 5,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for hp-uks-p-avd-001.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-95-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Capacity-95-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 95\r\n          | where HostPoolName =~ 'hp-uks-p-avd-001'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 6,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution for hp-uks-p-avd-002.\n-->Last Number in the string is the Percentage Remaining for the Host Pool\nOutput is:\nHostPoolName|ResourceGroup|Type|MaxSessionLimit|NumberHosts|TotalUsers|DisconnectedUser|ActiveUsers|SessionsAvailable|HostPoolPercentageLoad",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Capacity-95-Percent",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Capacity-95-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > now() - 5m\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend MaxSessionLimit=toint(split(ResultDescription, '|')[3])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsTotal=toint(split(ResultDescription, '|')[5])\r\n          | extend UserSessionsDisconnected=toint(split(ResultDescription, '|')[6])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend UserSessionsAvailable=toint(split(ResultDescription, '|')[8])\r\n          | extend HostPoolPercentLoad=toint(split(ResultDescription, '|')[9])\r\n          | extend HPResourceId=tostring(split(ResultDescription, '|')[13])\r\n          | extend ResourceId=tostring(HPResourceId)\r\n          | where HostPoolPercentLoad >= 95\r\n          | where HostPoolName =~ 'hp-uks-p-avd-002'\r\n          ",
        "_querycomment": "The query contains the name of the runbook and the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT30M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsTotal",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsDisconnected",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsActive",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserSessionsAvailable",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPoolPercentLoad",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 7,
        "description": "Verify Remote Desktop Policies are applied relating to Session Limits for hp-uks-p-avd-001. This could impact your scaling plan as well.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Disconnected-Users-Over-24-Hours",
        "evaluation_frequency": "PT1H",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Disconnected-Users-Over-24-Hours-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// Session duration \n// Lists users by session duration in the last 24 hours. \n// The \"State\" provides information on the connection stage of an activity.\n// The delta between \"Connected\" and \"Completed\" provides the connection time for a specific connection.\nWVDConnections \n| where TimeGenerated > ago(24h) \n| where State == \"Connected\" \n| where _ResourceId contains \"hp-uks-p-avd-001\" \n| project CorrelationId , UserName, ConnectionType, StartTime=TimeGenerated, SessionHostName\n| join (WVDConnections  \n    | where State == \"Completed\"  \n    | project EndTime=TimeGenerated, CorrelationId)  \n    on CorrelationId  \n| project Duration = EndTime - StartTime, ConnectionType, UserName, SessionHostName\n| where Duration >= timespan(24:00:00)\n| sort by Duration desc",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 8,
        "description": "Verify Remote Desktop Policies are applied relating to Session Limits for hp-uks-p-avd-002. This could impact your scaling plan as well.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Disconnected-Users-Over-24-Hours",
        "evaluation_frequency": "PT1H",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Disconnected-Users-Over-24-Hours-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// Session duration \n// Lists users by session duration in the last 24 hours. \n// The \"State\" provides information on the connection stage of an activity.\n// The delta between \"Connected\" and \"Completed\" provides the connection time for a specific connection.\nWVDConnections \n| where TimeGenerated > ago(24h) \n| where State == \"Connected\" \n| where _ResourceId contains \"hp-uks-p-avd-002\" \n| project CorrelationId , UserName, ConnectionType, StartTime=TimeGenerated, SessionHostName\n| join (WVDConnections  \n    | where State == \"Completed\"  \n    | project EndTime=TimeGenerated, CorrelationId)  \n    on CorrelationId  \n| project Duration = EndTime - StartTime, ConnectionType, UserName, SessionHostName\n| where Duration >= timespan(24:00:00)\n| sort by Duration desc",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 9,
        "description": "Verify Remote Desktop Policies are applied relating to Session Limits for hp-uks-p-avd-001. This could impact your scaling plan as well.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Disconnected-Users-Over-72-Hours",
        "evaluation_frequency": "PT1H",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Disconnected-Users-Over-72-Hours-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// Session duration \n// Lists users by session duration in the last 24 hours. \n// The \"State\" provides information on the connection stage of an activity.\n// The delta between \"Connected\" and \"Completed\" provides the connection time for a specific connection.\nWVDConnections \n| where TimeGenerated > ago(24h) \n| where State == \"Connected\" \n| where _ResourceId contains \"hp-uks-p-avd-001\" \n| project CorrelationId , UserName, ConnectionType, StartTime=TimeGenerated, SessionHostName\n| join (WVDConnections  \n    | where State == \"Completed\"  \n    | project EndTime=TimeGenerated, CorrelationId)  \n    on CorrelationId  \n| project Duration = EndTime - StartTime, ConnectionType, UserName, SessionHostName\n| where Duration >= timespan(24:00:00)\n| sort by Duration desc",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 10,
        "description": "Verify Remote Desktop Policies are applied relating to Session Limits for hp-uks-p-avd-002. This could impact your scaling plan as well.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-Disconnected-Users-Over-72-Hours",
        "evaluation_frequency": "PT1H",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-Disconnected-Users-Over-72-Hours-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// Session duration \n// Lists users by session duration in the last 24 hours. \n// The \"State\" provides information on the connection stage of an activity.\n// The delta between \"Connected\" and \"Completed\" provides the connection time for a specific connection.\nWVDConnections \n| where TimeGenerated > ago(24h) \n| where State == \"Connected\" \n| where _ResourceId contains \"hp-uks-p-avd-002\" \n| project CorrelationId , UserName, ConnectionType, StartTime=TimeGenerated, SessionHostName\n| join (WVDConnections  \n    | where State == \"Completed\"  \n    | project EndTime=TimeGenerated, CorrelationId)  \n    on CorrelationId  \n| project Duration = EndTime - StartTime, ConnectionType, UserName, SessionHostName\n| where Duration >= timespan(24:00:00)\n| sort by Duration desc",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 11,
        "description": "Catastrophic Event! Indicates potential problems with dependencies, diagnose and resolve for hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-No-Resource-Available",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-No-Resource-Available-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "WVDConnections \n| where TimeGenerated > ago (15m) \n| where _ResourceId contains \"hp-uks-p-avd-001\" \n| project-away TenantId,SourceSystem  \n| summarize arg_max(TimeGenerated, *), StartTime =  min(iff(State== 'Started', TimeGenerated , datetime(null) )), ConnectTime = min(iff(State== 'Connected', TimeGenerated , datetime(null) ))   by CorrelationId  \n| join kind=leftouter (WVDErrors\n    |summarize Errors=makelist(pack('Code', Code, 'CodeSymbolic', CodeSymbolic, 'Time', TimeGenerated, 'Message', Message ,'ServiceError', ServiceError, 'Source', Source)) by CorrelationId  \n    ) on CorrelationId\n| join kind=leftouter (WVDCheckpoints\n    | summarize Checkpoints=makelist(pack('Time', TimeGenerated, 'Name', Name, 'Parameters', Parameters, 'Source', Source)) by CorrelationId  \n    | mv-apply Checkpoints on (  \n        order by todatetime(Checkpoints['Time']) asc\n        | summarize Checkpoints=makelist(Checkpoints)\n        )\n    ) on CorrelationId  \n| project-away CorrelationId1, CorrelationId2  \n| order by TimeGenerated desc\n| where Errors[0].CodeSymbolic == \"ConnectionFailedNoHealthyRdshAvailable\"\n\n",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 12,
        "description": "Catastrophic Event! Indicates potential problems with dependencies, diagnose and resolve for hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-No-Resource-Available",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-No-Resource-Available-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "WVDConnections \n| where TimeGenerated > ago (15m) \n| where _ResourceId contains \"hp-uks-p-avd-002\" \n| project-away TenantId,SourceSystem  \n| summarize arg_max(TimeGenerated, *), StartTime =  min(iff(State== 'Started', TimeGenerated , datetime(null) )), ConnectTime = min(iff(State== 'Connected', TimeGenerated , datetime(null) ))   by CorrelationId  \n| join kind=leftouter (WVDErrors\n    |summarize Errors=makelist(pack('Code', Code, 'CodeSymbolic', CodeSymbolic, 'Time', TimeGenerated, 'Message', Message ,'ServiceError', ServiceError, 'Source', Source)) by CorrelationId  \n    ) on CorrelationId\n| join kind=leftouter (WVDCheckpoints\n    | summarize Checkpoints=makelist(pack('Time', TimeGenerated, 'Name', Name, 'Parameters', Parameters, 'Source', Source)) by CorrelationId  \n    | mv-apply Checkpoints on (  \n        order by todatetime(Checkpoints['Time']) asc\n        | summarize Checkpoints=makelist(Checkpoints)\n        )\n    ) on CorrelationId  \n| project-away CorrelationId1, CorrelationId2  \n| order by TimeGenerated desc\n| where Errors[0].CodeSymbolic == \"ConnectionFailedNoHealthyRdshAvailable\"\n\n",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 13,
        "description": "While trying to connect to hp-uks-p-avd-001 a user had an error and failed to connect to a VM. There are lots of variables between the end uers and AVD VMs. If this is frequent for the user, determine if their Internet connection is slow or latency is over 150 ms. Regarding hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-User-Connection-Failed",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-User-Connection-Failed-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          // Connection Errors\r\n          // List connection checkpoints and errors for each connection attempt, along with detailed information across all users.\r\n          //You can also uncomment the where clause to filter to a specific user if you are troubleshooting an issue.\r\n          WVDConnections\r\n          //| where UserName == \"upn.here@contoso.com\"\r\n          | project-away TenantId,SourceSystem\r\n          | summarize arg_max(TimeGenerated, *), StartTime = min(iff(State=='Started', TimeGenerated , datetime(null) )), ConnectTime = min(iff(State=='Connected', TimeGenerated , datetime(null) )) by CorrelationId\r\n          | join kind=leftouter\r\n          (\r\n              WVDErrors\r\n              |summarize Errors=make_list(pack('Code', Code, 'CodeSymbolic', CodeSymbolic, 'Time', TimeGenerated, 'Message', Message ,'ServiceError', ServiceError, 'Source', Source)) by CorrelationId\r\n          ) on CorrelationId\r\n          | join kind=leftouter\r\n          (\r\n              WVDCheckpoints\r\n              | summarize Checkpoints=make_list(pack('Time', TimeGenerated, 'Name', Name, 'Parameters', Parameters, 'Source', Source)) by CorrelationId\r\n              | mv-apply Checkpoints on\r\n              (\r\n                  order by todatetime(Checkpoints['Time']) asc\r\n                  | summarize Checkpoints=make_list(Checkpoints)\r\n              )\r\n          ) on CorrelationId\r\n          | project-away CorrelationId1, CorrelationId2\r\n          | order by TimeGenerated desc\r\n          | where TimeGenerated > ago(15m)\r\n          | extend ResourceGroup=tostring(split(_ResourceId, '/')[4])\r\n          | extend HostPool=tostring(split(_ResourceId, '/')[8])\r\n          | where HostPool =~ 'hp-uks-p-avd-001'\r\n          | extend ErrorShort=tostring(Errors[0].CodeSymbolic)\r\n          | extend ErrorMessage=tostring(Errors[0].Message)\r\n          | project TimeGenerated, HostPool, ResourceGroup, UserName, ClientOS, ClientVersion, ClientSideIPAddress, ConnectionType, ErrorShort, ErrorMessage\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 3,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ResourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientOS",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientVersion",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientSideIPAddress",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ConnectionType",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ErrorShort",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ErrorMessage",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 14,
        "description": "While trying to connect to hp-uks-p-avd-002 a user had an error and failed to connect to a VM. There are lots of variables between the end uers and AVD VMs. If this is frequent for the user, determine if their Internet connection is slow or latency is over 150 ms. Regarding hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-User-Connection-Failed",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HP-User-Connection-Failed-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          // Connection Errors\r\n          // List connection checkpoints and errors for each connection attempt, along with detailed information across all users.\r\n          //You can also uncomment the where clause to filter to a specific user if you are troubleshooting an issue.\r\n          WVDConnections\r\n          //| where UserName == \"upn.here@contoso.com\"\r\n          | project-away TenantId,SourceSystem\r\n          | summarize arg_max(TimeGenerated, *), StartTime = min(iff(State=='Started', TimeGenerated , datetime(null) )), ConnectTime = min(iff(State=='Connected', TimeGenerated , datetime(null) )) by CorrelationId\r\n          | join kind=leftouter\r\n          (\r\n              WVDErrors\r\n              |summarize Errors=make_list(pack('Code', Code, 'CodeSymbolic', CodeSymbolic, 'Time', TimeGenerated, 'Message', Message ,'ServiceError', ServiceError, 'Source', Source)) by CorrelationId\r\n          ) on CorrelationId\r\n          | join kind=leftouter\r\n          (\r\n              WVDCheckpoints\r\n              | summarize Checkpoints=make_list(pack('Time', TimeGenerated, 'Name', Name, 'Parameters', Parameters, 'Source', Source)) by CorrelationId\r\n              | mv-apply Checkpoints on\r\n              (\r\n                  order by todatetime(Checkpoints['Time']) asc\r\n                  | summarize Checkpoints=make_list(Checkpoints)\r\n              )\r\n          ) on CorrelationId\r\n          | project-away CorrelationId1, CorrelationId2\r\n          | order by TimeGenerated desc\r\n          | where TimeGenerated > ago(15m)\r\n          | extend ResourceGroup=tostring(split(_ResourceId, '/')[4])\r\n          | extend HostPool=tostring(split(_ResourceId, '/')[8])\r\n          | where HostPool =~ 'hp-uks-p-avd-002'\r\n          | extend ErrorShort=tostring(Errors[0].CodeSymbolic)\r\n          | extend ErrorMessage=tostring(Errors[0].Message)\r\n          | project TimeGenerated, HostPool, ResourceGroup, UserName, ClientOS, ClientVersion, ClientSideIPAddress, ConnectionType, ErrorShort, ErrorMessage\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 3,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ResourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "UserName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientOS",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientVersion",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ClientSideIPAddress",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ConnectionType",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ErrorShort",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "ErrorMessage",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 15,
        "description": "VM is available for use but one of the dependent resources is in a failed state for hostpool hp-uks-p-avd-001",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Health-Check-Failure",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Health-Check-Failure-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// HealthChecks of SessionHost \n// Renders a summary of SessionHost health status. \nlet MapToDesc = (idx: long) {\n    case(idx == 0, \"DomainJoin\",\n    idx == 1, \"DomainTrust\",\n    idx == 2, \"FSLogix\",\n    idx == 3, \"SxSStack\",\n    idx == 4, \"URLCheck\",\n    idx == 5, \"GenevaAgent\",\n    idx == 6, \"DomainReachable\",\n    idx == 7, \"WebRTCRedirector\",\n    idx == 8, \"SxSStackEncryption\",\n    idx == 9, \"IMDSReachable\",\n    idx == 10, \"MSIXPackageStaging\",\n    \"InvalidIndex\")\n};\nWVDAgentHealthStatus\n| where TimeGenerated > ago(10m)\n| where Status != 'Available'\n| where AllowNewSessions = True\n| extend CheckFailed = parse_json(SessionHostHealthCheckResult)\n| mv-expand CheckFailed\n| where CheckFailed.AdditionalFailureDetails.ErrorCode != 0\n| extend HealthCheckName = tolong(CheckFailed.HealthCheckName)\n| extend HealthCheckResult = tolong(CheckFailed.HealthCheckResult)\n| extend HealthCheckDesc = MapToDesc(HealthCheckName)\n| where HealthCheckDesc != 'InvalidIndex'\n| where _ResourceId contains \"hp-uks-p-avd-001\"\n| parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" HostPoolResourceGroup \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\n| parse SessionHostResourceId with \"/subscriptions/\" HostSubscription \"/resourceGroups/\" SessionHostRG \" /providers/Microsoft.Compute/virtualMachines/\" SessionHostName\n",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HealthCheckDesc",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostRG",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 16,
        "description": "VM is available for use but one of the dependent resources is in a failed state for hostpool hp-uks-p-avd-002",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Health-Check-Failure",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Health-Check-Failure-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "// HealthChecks of SessionHost \n// Renders a summary of SessionHost health status. \nlet MapToDesc = (idx: long) {\n    case(idx == 0, \"DomainJoin\",\n    idx == 1, \"DomainTrust\",\n    idx == 2, \"FSLogix\",\n    idx == 3, \"SxSStack\",\n    idx == 4, \"URLCheck\",\n    idx == 5, \"GenevaAgent\",\n    idx == 6, \"DomainReachable\",\n    idx == 7, \"WebRTCRedirector\",\n    idx == 8, \"SxSStackEncryption\",\n    idx == 9, \"IMDSReachable\",\n    idx == 10, \"MSIXPackageStaging\",\n    \"InvalidIndex\")\n};\nWVDAgentHealthStatus\n| where TimeGenerated > ago(10m)\n| where Status != 'Available'\n| where AllowNewSessions = True\n| extend CheckFailed = parse_json(SessionHostHealthCheckResult)\n| mv-expand CheckFailed\n| where CheckFailed.AdditionalFailureDetails.ErrorCode != 0\n| extend HealthCheckName = tolong(CheckFailed.HealthCheckName)\n| extend HealthCheckResult = tolong(CheckFailed.HealthCheckResult)\n| extend HealthCheckDesc = MapToDesc(HealthCheckName)\n| where HealthCheckDesc != 'InvalidIndex'\n| where _ResourceId contains \"hp-uks-p-avd-002\"\n| parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" HostPoolResourceGroup \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\n| parse SessionHostResourceId with \"/subscriptions/\" HostSubscription \"/resourceGroups/\" SessionHostRG \" /providers/Microsoft.Compute/virtualMachines/\" SessionHostName\n",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "SessionHostName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HealthCheckDesc",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "SessionHostRG",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 17,
        "description": "VM is assigned to a user but one of the dependent resources is in a failed state for hostpool hp-uks-p-avd-001",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Personal-Assigned-Health-Check-Failure",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Personal-Assigned-Health-Check-Failure-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          // Personal Session Host where Health status is NOT healthy and the VM is assigned\r\n          AzureDiagnostics\r\n          | where Category has \"JobStreams\"\r\n              and StreamType_s == \"Output\"\r\n              and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > ago(15m)\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend NumPersonalUnhealthy=toint(split(ResultDescription, '|')[10])\r\n          | extend PersonalSessionHost=extract_json(\"$.SessionHost\", tostring(split(ResultDescription, '|')[11]), typeof(string))\r\n          | extend PersonalAssignedUser=extract_json(\"$.AssignedUser\", tostring(split(ResultDescription, '|')[11]), typeof(string))\r\n          | where HostPoolName =~ 'hp-uks-p-avd-001'\r\n          | where Type == 'Personal'\r\n          | where NumPersonalUnhealthy > 0\r\n          ",
        "_querycomment": "The query contains the name of the runbook and hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "PersonalSessionHost",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "PersonalAssignedUser",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 18,
        "description": "VM is assigned to a user but one of the dependent resources is in a failed state for hostpool hp-uks-p-avd-002",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Personal-Assigned-Health-Check-Failure",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Personal-Assigned-Health-Check-Failure-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          // Personal Session Host where Health status is NOT healthy and the VM is assigned\r\n          AzureDiagnostics\r\n          | where Category has \"JobStreams\"\r\n              and StreamType_s == \"Output\"\r\n              and RunbookName_s == \"AvdHostPoolLogData\"\r\n          | sort by TimeGenerated\r\n          | where TimeGenerated > ago(15m)\r\n          | extend HostPoolName=tostring(split(ResultDescription, '|')[0])\r\n          | extend ResourceGroup=tostring(split(ResultDescription, '|')[1])\r\n          | extend Type=tostring(split(ResultDescription, '|')[2])\r\n          | extend NumberSessionHosts=toint(split(ResultDescription, '|')[4])\r\n          | extend UserSessionsActive=toint(split(ResultDescription, '|')[7])\r\n          | extend NumPersonalUnhealthy=toint(split(ResultDescription, '|')[10])\r\n          | extend PersonalSessionHost=extract_json(\"$.SessionHost\", tostring(split(ResultDescription, '|')[11]), typeof(string))\r\n          | extend PersonalAssignedUser=extract_json(\"$.AssignedUser\", tostring(split(ResultDescription, '|')[11]), typeof(string))\r\n          | where HostPoolName =~ 'hp-uks-p-avd-002'\r\n          | where Type == 'Personal'\r\n          | where NumPersonalUnhealthy > 0\r\n          ",
        "_querycomment": "The query contains the name of the runbook and hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "HostPoolName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "PersonalSessionHost",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "PersonalAssignedUser",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 19,
        "description": "Disk space Critically Low. \nConsider review of the VM local C drive and determine what is consuming disk space for the VM in hp-uks-p-avd-001. This could be local profiles or temp files that need to be cleaned up or removed.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Local-Disk-Free-Space-5-Percent",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Local-Disk-Free-Space-5-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Perf\r\n          | where TimeGenerated > ago(15m)\r\n          | where ObjectName == \"LogicalDisk\" and CounterName == \"% Free Space\"\r\n          | where InstanceName !contains \"D:\"\r\n          | where InstanceName  !contains \"_Total\"| where CounterValue <= 5.00\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | summarize arg_max(TimeGenerated, *) by ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, CounterValue, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n          (\r\n              WVDAgentHealthStatus\r\n              | where TimeGenerated > ago(15m)\r\n              | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n              | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n              | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n              | extend ComputerName=tolower(ComputerName)\r\n              | summarize arg_max(TimeGenerated,*) by ComputerName\r\n              | project VMresourceGroup, ComputerName, HostPool, _ResourceId\r\n              ) on ComputerName\r\n          | where ComputerName1 contains ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 20,
        "description": "Disk space Critically Low. \nConsider review of the VM local C drive and determine what is consuming disk space for the VM in hp-uks-p-avd-002. This could be local profiles or temp files that need to be cleaned up or removed.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Local-Disk-Free-Space-5-Percent",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Local-Disk-Free-Space-5-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Perf\r\n          | where TimeGenerated > ago(15m)\r\n          | where ObjectName == \"LogicalDisk\" and CounterName == \"% Free Space\"\r\n          | where InstanceName !contains \"D:\"\r\n          | where InstanceName  !contains \"_Total\"| where CounterValue <= 5.00\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | summarize arg_max(TimeGenerated, *) by ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, CounterValue, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n          (\r\n              WVDAgentHealthStatus\r\n              | where TimeGenerated > ago(15m)\r\n              | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n              | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n              | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n              | extend ComputerName=tolower(ComputerName)\r\n              | summarize arg_max(TimeGenerated,*) by ComputerName\r\n              | project VMresourceGroup, ComputerName, HostPool, _ResourceId\r\n              ) on ComputerName\r\n          | where ComputerName1 contains ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 21,
        "description": "Disk space Moderately Low. \nConsider review of the VM local C drive and determine what is consuming disk space for the VM in hp-uks-p-avd-001. This could be local profiles or temp files that need to be cleaned up or removed.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Local-Disk-Free-Space-10-Percent",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Local-Disk-Free-Space-10-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Perf\r\n          | where TimeGenerated > ago(15m)\r\n          | where ObjectName == \"LogicalDisk\" and CounterName == \"% Free Space\"\r\n          | where InstanceName !contains \"D:\"\r\n          | where InstanceName  !contains \"_Total\"| where CounterValue <= 10.00\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | summarize arg_max(TimeGenerated, *) by ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, CounterValue, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n          (\r\n              WVDAgentHealthStatus\r\n              | where TimeGenerated > ago(15m)\r\n              | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n              | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n              | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n              | extend ComputerName=tolower(ComputerName)\r\n              | summarize arg_max(TimeGenerated,*) by ComputerName\r\n              | project VMresourceGroup, ComputerName, HostPool, _ResourceId\r\n              ) on ComputerName\r\n          | where ComputerName1 contains ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 22,
        "description": "Disk space Moderately Low. \nConsider review of the VM local C drive and determine what is consuming disk space for the VM in hp-uks-p-avd-002. This could be local profiles or temp files that need to be cleaned up or removed.",
        "_descriptioncomment": "The description contains the name of the hostpool",
        "display_name": "AVD-HostPool-VM-Local-Disk-Free-Space-10-Percent",
        "evaluation_frequency": "PT15M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-Local-Disk-Free-Space-10-Percent-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Perf\r\n          | where TimeGenerated > ago(15m)\r\n          | where ObjectName == \"LogicalDisk\" and CounterName == \"% Free Space\"\r\n          | where InstanceName !contains \"D:\"\r\n          | where InstanceName  !contains \"_Total\"| where CounterValue <= 10.00\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | summarize arg_max(TimeGenerated, *) by ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, CounterValue, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n          (\r\n              WVDAgentHealthStatus\r\n              | where TimeGenerated > ago(15m)\r\n              | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n              | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n              | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n              | extend ComputerName=tolower(ComputerName)\r\n              | summarize arg_max(TimeGenerated,*) by ComputerName\r\n              | project VMresourceGroup, ComputerName, HostPool, _ResourceId\r\n              ) on ComputerName\r\n          | where ComputerName1 contains ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT15M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 23,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution.\nNOTE: The Runbook will FAIL if Networking for the storage account has anything other than \"Enabled from all networks\"\n-->Last Number in the string is the Percentage Remaining for the Share.\nOutput: ResultsDescription\nStorageType,Subscription,ResourceGroup,StorageAccount,ShareName,Quota,GBUsed,PercentRemaining",
        "_descriptioncomment": "The description doesn't contain the name of the hostpool",
        "display_name": "AVD-Storage-Low-Space-on-Azure-File-Share-5-Percent-Remaining",
        "evaluation_frequency": "PT10M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-Storage-Low-Space-on-Azure-File-Share-5-Percent-Remaining-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdStorageLogData\"\r\n          | where split(ResultDescription, ',')[1] <> \"\"\r\n          //  StorageType / Subscription / RG / StorAcct / Share / Quota / GB Used / %Available\r\n          | extend StorageType=split(ResultDescription, ',')[0]\r\n          | extend Subscription=split(ResultDescription, ',')[1]\r\n          | extend ResourceGroup=split(ResultDescription, ',')[2]\r\n          | extend StorageAccount=tostring(split(ResultDescription, ',')[3])\r\n          | extend Share=tostring(split(ResultDescription, ',')[4])\r\n          | extend GBShareQuota=split(ResultDescription, ',')[5]\r\n          | extend GBUsed=split(ResultDescription, ',')[6]\r\n          | extend PercentAvailable=round(toreal(split(ResultDescription, ',')[7]))\r\n          | extend ResourceId=tostring(split(ResultDescription, ',')[8])\r\n          | summarize arg_max(TimeGenerated, *) by Share\r\n          | where PercentAvailable <= 5.00\r\n          | project TimeGenerated,ResourceId, StorageAccount, Share, PercentAvailable\r\n          ",
        "_querycomment": "The query contains the name of the runbook",
        "resource_id_column": "ResourceId",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "StorageAccount",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "Share",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 24,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution.\nNOTE: The Runbook will FAIL if Networking for the storage account has anything other than \"Enabled from all networks\"\n-->Last Number in the string is the Percentage Remaining for the Share.\nOutput: ResultsDescription\nStorageType,Subscription,ResourceGroup,StorageAccount,ShareName,Quota,GBUsed,PercentRemaining",
        "_descriptioncomment": "The description doesn't contain the name of the hostpool",
        "display_name": "AVD-Storage-Low-Space-on-Azure-File-Share-5-Percent-Remaining",
        "evaluation_frequency": "PT10M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-Storage-Low-Space-on-Azure-File-Share-5-Percent-Remaining-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdStorageLogData\"\r\n          | where split(ResultDescription, ',')[1] <> \"\"\r\n          //  StorageType / Subscription / RG / StorAcct / Share / Quota / GB Used / %Available\r\n          | extend StorageType=split(ResultDescription, ',')[0]\r\n          | extend Subscription=split(ResultDescription, ',')[1]\r\n          | extend ResourceGroup=split(ResultDescription, ',')[2]\r\n          | extend StorageAccount=tostring(split(ResultDescription, ',')[3])\r\n          | extend Share=tostring(split(ResultDescription, ',')[4])\r\n          | extend GBShareQuota=split(ResultDescription, ',')[5]\r\n          | extend GBUsed=split(ResultDescription, ',')[6]\r\n          | extend PercentAvailable=round(toreal(split(ResultDescription, ',')[7]))\r\n          | extend ResourceId=tostring(split(ResultDescription, ',')[8])\r\n          | summarize arg_max(TimeGenerated, *) by Share\r\n          | where PercentAvailable <= 5.00\r\n          | project TimeGenerated,ResourceId, StorageAccount, Share, PercentAvailable\r\n          ",
        "_querycomment": "The query contains the name of the runbook",
        "resource_id_column": "ResourceId",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "StorageAccount",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "Share",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 25,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution.\nNOTE: The Runbook will FAIL if Networking for the storage account has anything other than \"Enabled from all networks\"\n-->Last Number in the string is the Percentage Remaining for the Share.\nOutput: ResultsDescription\nStorageType,Subscription,ResourceGroup,StorageAccount,ShareName,Quota,GBUsed,PercentRemaining",
        "_descriptioncomment": "The description doesn't contain the name of the hostpool",
        "display_name": "AVD-Storage-Low-Space-on-Azure-File-Share-15-Percent-Remaining",
        "evaluation_frequency": "PT10M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-Storage-Low-Space-on-Azure-File-Share-15-Percent-Remaining-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdStorageLogData\"\r\n          | where split(ResultDescription, ',')[1] <> \"\"\r\n          //  StorageType / Subscription / RG / StorAcct / Share / Quota / GB Used / %Available\r\n          | extend StorageType=split(ResultDescription, ',')[0]\r\n          | extend Subscription=split(ResultDescription, ',')[1]\r\n          | extend ResourceGroup=split(ResultDescription, ',')[2]\r\n          | extend StorageAccount=tostring(split(ResultDescription, ',')[3])\r\n          | extend Share=tostring(split(ResultDescription, ',')[4])\r\n          | extend GBShareQuota=split(ResultDescription, ',')[5]\r\n          | extend GBUsed=split(ResultDescription, ',')[6]\r\n          | extend PercentAvailable=round(toreal(split(ResultDescription, ',')[7]))\r\n          | extend ResourceId=tostring(split(ResultDescription, ',')[8])\r\n          | summarize arg_max(TimeGenerated, *) by Share\r\n          | where PercentAvailable <= 15.00\r\n          | project TimeGenerated,ResourceId, StorageAccount, Share, PercentAvailable\r\n          ",
        "_querycomment": "The query contains the name of the runbook",
        "resource_id_column": "ResourceId",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "StorageAccount",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "Share",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 26,
        "description": "This alert is based on the Action Account and Runbook that populates the Log Analytics specificed with the AVD Metrics Deployment Solution.\nNOTE: The Runbook will FAIL if Networking for the storage account has anything other than \"Enabled from all networks\"\n-->Last Number in the string is the Percentage Remaining for the Share.\nOutput: ResultsDescription\nStorageType,Subscription,ResourceGroup,StorageAccount,ShareName,Quota,GBUsed,PercentRemaining",
        "_descriptioncomment": "The description doesn't contain the name of the hostpool",
        "display_name": "AVD-Storage-Low-Space-on-Azure-File-Share-15-Percent-Remaining",
        "evaluation_frequency": "PT10M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-Storage-Low-Space-on-Azure-File-Share-15-Percent-Remaining-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          AzureDiagnostics\r\n          | where Category has \"JobStreams\" and StreamType_s == \"Output\" and RunbookName_s == \"AvdStorageLogData\"\r\n          | where split(ResultDescription, ',')[1] <> \"\"\r\n          //  StorageType / Subscription / RG / StorAcct / Share / Quota / GB Used / %Available\r\n          | extend StorageType=split(ResultDescription, ',')[0]\r\n          | extend Subscription=split(ResultDescription, ',')[1]\r\n          | extend ResourceGroup=split(ResultDescription, ',')[2]\r\n          | extend StorageAccount=tostring(split(ResultDescription, ',')[3])\r\n          | extend Share=tostring(split(ResultDescription, ',')[4])\r\n          | extend GBShareQuota=split(ResultDescription, ',')[5]\r\n          | extend GBUsed=split(ResultDescription, ',')[6]\r\n          | extend PercentAvailable=round(toreal(split(ResultDescription, ',')[7]))\r\n          | extend ResourceId=tostring(split(ResultDescription, ',')[8])\r\n          | summarize arg_max(TimeGenerated, *) by Share\r\n          | where PercentAvailable <= 15.00\r\n          | project TimeGenerated,ResourceId, StorageAccount, Share, PercentAvailable\r\n          ",
        "_querycomment": "The query contains the name of the runbook",
        "resource_id_column": "ResourceId",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT1H",
        "dimensions": [
            {
                "name": "StorageAccount",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "Share",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 27,
        "description": "User Profile Service logged Event ID 62 or 63. The profile Disk was marked for compaction due to additional white space but failed. See error details for additional information regarding hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Compaction-Failed",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Compaction-Failed-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 62 or EventID == 63\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 28,
        "description": "User Profile Service logged Event ID 62 or 63. The profile Disk was marked for compaction due to additional white space but failed. See error details for additional information regarding hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Compaction-Failed",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Compaction-Failed-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 62 or EventID == 63\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 29,
        "description": "User Profile Service logged an Event ID 51. This indicates that a user attempted to load their profile disk but it was in use or possibly mapped to another VM. Ensure the user is not connected to another host pool or remote app with the same profile. Regarding hp-uks-p-avd-001",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Attached-to-another-VM",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Attached-to-another-VM-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Operational\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 51\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 30,
        "description": "User Profile Service logged an Event ID 51. This indicates that a user attempted to load their profile disk but it was in use or possibly mapped to another VM. Ensure the user is not connected to another host pool or remote app with the same profile. Regarding hp-uks-p-avd-002",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Attached-to-another-VM",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Attached-to-another-VM-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Operational\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 51\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 31,
        "description": "User Profiles Service logged an Event ID 52 or 40. Investigate error details for reason regarding hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Failed-to-Attach",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Failed-to-Attach-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 52 or EventID == 40\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 32,
        "description": "User Profiles Service logged an Event ID 52 or 40. Investigate error details for reason regarding hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Failed-to-Attach",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Disk-Failed-to-Attach-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 52 or EventID == 40\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 33,
        "description": "User Profiles Service logged Event ID 43. Verify network communications between the storage and AVD VM related to hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Failed-due-to-Network-Issue",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Failed-due-to-Network-Issue-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 43\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 34,
        "description": "User Profiles Service logged Event ID 43. Verify network communications between the storage and AVD VM related to hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Failed-due-to-Network-Issue",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Failed-due-to-Network-Issue-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 43\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 35,
        "description": "User Profile Service Disabled. Determine why service was disabled and re-enable / start the FSLogix service. Regarding hp-uks-p-avd-001",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Service-Disabled",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Service-Disabled-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 60\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n              ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 36,
        "description": "User Profile Service Disabled. Determine why service was disabled and re-enable / start the FSLogix service. Regarding hp-uks-p-avd-002",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-Service-Disabled",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-Service-Disabled-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 60\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n              ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "P1D",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 37,
        "description": "User Profile Service Disabled. Determine why service was disabled and re-enable / start the FSLogix service. Regarding hp-uks-p-avd-001",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-2-Percent-Free-Space",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-2-Percent-Free-Space-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 33\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 38,
        "description": "User Profile Service Disabled. Determine why service was disabled and re-enable / start the FSLogix service. Regarding hp-uks-p-avd-002",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-2-Percent-Free-Space",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-2-Percent-Free-Space-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Error\"\r\n          | where EventID == 33\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 1,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 39,
        "description": "User Profiles Service logged Event ID 33. Expand User's Virtual Profile Disk and/or clean up user profile data on the VM in hp-uks-p-avd-001.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-5-Percent-Free-Space",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-001",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-5-Percent-Free-Space-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 34\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-001\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    },
    {
        "index": 40,
        "description": "User Profiles Service logged Event ID 33. Expand User's Virtual Profile Disk and/or clean up user profile data on the VM in hp-uks-p-avd-002.",
        "_descriptioncomment": "The description contain the name of the hostpool",
        "display_name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-5-Percent-Free-Space",
        "evaluation_frequency": "PT5M",
        "hostpool_name": "hp-p-uks-avd-002",
        "minimum_failing_periods_to_trigger_alert": 1,
        "name": "AVD-HostPool-VM-FSLogix-Profile-LessThan-5-Percent-Free-Space-",
        "number_of_evaluation_periods": 1,
        "operator": "GreaterThanOrEqual",
        "query": "          Event\r\n          | where EventLog == \"Microsoft-FSLogix-Apps/Admin\"\r\n          | where EventLevelName == \"Warning\"\r\n          | where EventID == 34\r\n          | parse _ResourceId with \"/subscriptions/\" subscription \"/resourcegroups/\" ResourceGroup \"/providers/microsoft.compute/virtualmachines/\" ComputerName\r\n          | extend ComputerName=tolower(ComputerName)\r\n          | project ComputerName, RenderedDescription, subscription, ResourceGroup, TimeGenerated\r\n          | join kind = leftouter\r\n              (\r\n                WVDAgentHealthStatus\r\n                | where _ResourceId contains \"hp-uks-p-avd-002\"\r\n                | parse _ResourceId with \"/subscriptions/\" subscriptionAgentHealth \"/resourcegroups/\" ResourceGroupAgentHealth \"/providers/microsoft.desktopvirtualization/hostpools/\" HostPool\r\n                | parse SessionHostResourceId with \"/subscriptions/\" VMsubscription \"/resourceGroups/\" VMresourceGroup \"/providers/Microsoft.Compute/virtualMachines/\" ComputerName\r\n                | extend ComputerName=tolower(ComputerName)\r\n                | summarize arg_max(TimeGenerated,*) by ComputerName\r\n                | project VMresourceGroup, ComputerName, HostPool\r\n              ) on ComputerName\r\n          ",
        "_querycomment": "The query contains the name of the hostpool",
        "resource_id_column": "",
        "severity": 2,
        "time_aggregation_method": "Count",
        "threshold": 1,
        "window_duration": "PT5M",
        "dimensions": [
            {
                "name": "ComputerName",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "RenderedDescription",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "VMresourceGroup",
                "operator": "Include",
                "values": [
                    "*"
                ]
            },
            {
                "name": "HostPool",
                "operator": "Include",
                "values": [
                    "*"
                ]
            }
        ]
    }
]
